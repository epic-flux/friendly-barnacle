=LET(
    _state, [@State],
    _targetEnd, [@TargetEnd],
    _lastUpdated, [@LastUpdated],
    _daysUntilDue, IF(_targetEnd = "", "", _targetEnd - TODAY()),
    _daysSinceUpdate, IF(_lastUpdated = "", "", TODAY() - _lastUpdated),
    _staleThreshold, Config!$B$10,

    IF(OR(_state = "Done", _state = "Closed"), "âœ… Complete",
    IF(_targetEnd = "", "âš  Missing Dates",
    IF(_targetEnd < TODAY(), "ðŸ”´ Overdue",
    IF(AND(_daysSinceUpdate <> "", _daysSinceUpdate > _staleThreshold), "âšª Stale",
    IF(_daysUntilDue <= 7, "ðŸŸ  Due Soon",
    IF(_daysUntilDue <= 30, "ðŸŸ¡ Approaching",
    "ðŸŸ¢ On Track"))))))
)