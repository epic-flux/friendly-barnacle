# Monthly Milestone Report — Business Rules & Logic

**Resource Capacity Planner** | Cloud & Platforms PMO

| | |
|---|---|
| **Version** | 1.3 |
| **Date** | 22 February 2026 |

---

## 1. Purpose

The Monthly Milestone Report provides a single filtered view of **PMP milestones** for a given reporting period. It is designed for use in monthly resourcing meetings and quarterly reporting, answering three questions:

- What was completed this month?
- What is scheduled (in-flight or upcoming) this month?
- What should have been scheduled but has been delayed?

Milestones are sourced from Azure DevOps Features via Power Query and enriched with calculated columns in the `_MilestoneData` table. Only features flagged as PMP milestones (`IsPMPMilestone` = Yes) are included in this report.

---

## 2. Filters

### 2.1 Pre-Filter (Automatic)

Before any user-selectable filters are applied, the report excludes all features where `_MilestoneData.IsPMPMilestone` ≠ Yes. This is a hard filter that cannot be overridden by the user.

Only DevOps features/milestones with `IsPMPMilestone` = Yes appear in the monthly report view. Non-PMP features are excluded entirely — they do not appear in any category (Complete, Scheduled, or Delayed) regardless of their dates or status.

### 2.2 User-Selectable Filters

Three filters control the report. Month and Project filters support an "All" option that disables that filter axis. The Year filter defaults to the current Australian Financial Year and does not have an "All" option. Filters combine using **AND** logic — a milestone must satisfy all active filters to appear.

| Filter | Format | Examples |
|---|---|---|
| Year | Australian FY | FY25, FY26, FY27 (defaults to current FY) |
| Month | Three-letter abbreviation | Jan, Feb, Mar … Dec, All |
| Project | Project name text | "Network Refresh", All |

### Australian Financial Year Convention

FY26 runs from 1 July 2025 to 30 June 2026.

- Months **July through December** fall in the first calendar year (FY − 1).
- Months **January through June** fall in the second calendar year (FY itself).

| FY + Month | Resolves To |
|---|---|
| FY26 + Sep | September 2025 |
| FY26 + Feb | February 2026 |

### Default Behaviour

Year defaults to the current Australian Financial Year based on today's date. Users can manually select a different financial year from the dropdown. Because Year always resolves to a specific FY, every reporting period is anchored to a known financial year.

When Month is "All" and a specific Year is selected, the report shows the full financial year (July to June).

---

## 3. Milestone Categories

The classification logic operates on the **pre-filtered dataset** — only milestones where `IsPMPMilestone` = Yes (see [Section 2.1](#21-pre-filter-automatic)).

Every milestone is classified into exactly one of three categories based on a strict evaluation order. Once a milestone matches a category, it is excluded from subsequent checks. This guarantees no duplicates.

**Evaluation order:** Complete → Scheduled → Delayed

Milestones that do not match any category are excluded from the report.

The category label is output to the `Status` column in the monthly report (see [Section 6](#6-output-columns)).

### 3.1 Complete

**Definition:** The milestone has a `ClosedDate` in Azure DevOps, and that `ClosedDate` falls within the selected reporting period.

**How it works:**

- DevOps populates the `ClosedDate` field automatically when a work item transitions to a state mapped to the "Completed" state category.
- The report checks whether the `ClosedDate`'s month and financial year match the selected filter values.
- If Month is "All", the month check is skipped; the `ClosedDate` need only fall within the selected financial year.

> A milestone is Complete even if its planned dates also overlap the period. Completion takes precedence over all other categories.

### 3.2 Scheduled

**Definition:** The milestone is NOT complete in the reporting period, AND its effective date range overlaps with the reporting period.

#### Date Fallback Logic

The system uses "effective dates" with a two-tier fallback:

1. **First preference:** `PlannedStartDate` and `TargetEndDate` — the current working dates maintained in DevOps.
2. **Fallback:** `OriginalStartDate_PMP` and `OriginalEndDate_PMP` — the baseline dates from the Project Management Plan.

Start and end dates are resolved independently — e.g. `PlannedStartDate` may be available while `TargetEndDate` is missing, in which case the system uses `PlannedStartDate` for the start and falls back to `OriginalEndDate_PMP` for the end.

If neither tier provides a usable date for both start and end, the milestone cannot be classified as Scheduled and falls through to the Delayed check.

#### Overlap Test

A milestone overlaps the reporting period when **both** of these are true:

```
Effective Start Date  <=  Last day of the reporting period
Effective End Date    >=  First day of the reporting period
```

This standard range-overlap test correctly captures milestones that:

- Start before and end during the period
- Start and end entirely within the period
- Start during and end after the period
- Span the entire period

### 3.3 Delayed

**Definition:** The milestone is NOT complete and NOT scheduled in the reporting period, BUT its original PMP baseline dates indicate it SHOULD have been active during this period, AND its planned start has been pushed beyond the period (or no planned start exists at all).

> *"According to the original plan, this milestone should be happening now. But it hasn't been scheduled yet, or it's been pushed out."*

**Conditions** (all must be true):

1. Not already classified as Complete or Scheduled.
2. `OriginalStartDate_PMP` and `OriginalEndDate_PMP` both exist.
3. The original PMP date range overlaps the reporting period (same overlap test as Scheduled).
4. **Either:**
   - (a) `PlannedStartDate` exists but is **after** the reporting period end (milestone has been explicitly pushed out), **or**
   - (b) `PlannedStartDate` does not exist (milestone has never been scheduled).

**What this catches:**

- Milestones where the PM has pushed the start date into a future month.
- Milestones that were baselined but never had working dates assigned.

**What this does NOT catch:**

- Milestones that started on time but are overrunning — these appear as Scheduled because their effective dates still overlap the period.
- Overrunning milestones are better identified via the `IsOverdue` calculated column (`TargetEndDate` < `TODAY` and Status ≠ Complete) which is handled separately by conditional formatting on the Milestones sheet.

---

## 4. Sort Order

Results are sorted in two tiers:

- **Primary sort:** Status value order — Complete first, then Scheduled, then Delayed.
- **Secondary sort:** Date ascending within each category.

The date used for secondary sorting depends on the category:

| Category | Sort Date |
|---|---|
| Complete | `ClosedDate` (when it was finished) |
| Scheduled | `Effective End` (when it's due) |
| Delayed | `OriginalEndDate_PMP` (when it was due) |

If no usable sort date exists, the milestone sorts to the bottom of its category group.

---

## 5. Edge Cases & Defensive Handling

### 5.1 Non-PMP Milestones

Features where `IsPMPMilestone` ≠ Yes are excluded from the monthly report entirely. They are not evaluated against any category logic and do not appear in any filter combination. This is applied as a hard pre-filter before all other processing (see [Section 2.1](#21-pre-filter-automatic)).

### 5.2 Missing Dates

- If `ClosedDate` is blank, the milestone cannot be Complete.
- If all four date fields (`PlannedStartDate`, `TargetEndDate`, `OriginalStartDate_PMP`, `OriginalEndDate_PMP`) are blank, the milestone is excluded from the report entirely.
- If planned dates are blank but PMP originals exist, the milestone can still qualify as Scheduled (via fallback) or Delayed.

### 5.3 Invalid Date Values

All date columns are validated using `ISNUMBER()` before comparison. Text values, errors, or blank cells are treated as "no date available" and trigger the fallback cascade.

### 5.4 No Matches

- If the `_MilestoneData` table contains no rows (e.g. Power Query has not been refreshed), the report displays:
  > `No milestone data available — refresh Power Query`
- If milestones exist but none match the combined filters, the report displays the active filter values in the message:
  > `No milestones found for FY26 · Feb · All Projects`
- When a specific Project filter is active and returns no results, the message includes a hint:
  > `No milestones found for FY26 · Feb · Network Refresh — try setting Project to All`

### 5.5 Milestone Closed and Reopened

DevOps updates `ClosedDate` to reflect the most recent closure. If a milestone is reopened, `ClosedDate` is cleared and the milestone reverts to Scheduled or Delayed based on its dates.

---

## 6. Output Columns

The monthly report displays a simplified subset of `_MilestoneData` fields, tailored for use in resourcing meetings and quarterly reporting.

| Column | Source | Description |
|---|---|---|
| DevOpsID | `WorkItemId` + `DevOpsLink` | Numeric ID (e.g. 45367) displayed as a clickable hyperlink to the DevOps work item |
| Title | `Title` | Milestone name |
| Effective Start | `PlannedStartDate`, falling back to `OriginalStartDate_PMP` | Resolved start date after fallback |
| Effective End | `TargetEndDate`, falling back to `OriginalEndDate_PMP` | Resolved end date after fallback |
| Status | Calculated category label | "Complete", "Scheduled", or "Delayed" |
| Critical Milestone | `IsCriticalDate` | Yes/No flag |
| Key Milestone | `IsKeyFeature` | Yes/No flag |

> **Note:** The Status column does not show the DevOps state (New, Active, Resolved, Closed). It is populated with the calculated category label from the milestone classification logic described in [Section 3](#3-milestone-categories).

---

## 7. Relationship to Other Views

This report complements (does not replace) the existing Milestones sheet filters. The key differences:

| Aspect | Milestones Sheet | Monthly Report |
|---|---|---|
| Scope | All milestones | PMP milestones only (`IsPMPMilestone` = Yes) |
| Filtering | By individual field values (PM, Area, Status, Month, Quarter) | By reporting period (FY + Month) with category logic |
| View | Current state of all milestones | What happened / should have happened in a specific month |
| Sort | By Target End Date | By Status then Date |
| Use case | Day-to-day milestone tracking | Monthly resourcing meetings and quarterly reporting |
